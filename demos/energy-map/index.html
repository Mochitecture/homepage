<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>Energy Map | Mochitecture</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" href="/mochitecture_icon.png">
  <link rel="stylesheet" href="/assets/base.css">
  <link rel="stylesheet" href="/demos/energy-map/energy-map.css">
  <script defer src="/assets/include.js"></script>
  <script defer src="/demos/energy-map/energy-map.js"></script>
</head>
<body>
  <div data-include="/partials/header.html"></div>

  <main class="site-main">
    <div class="em-wrap">
      <header class="em-header">
        <h1 class="page-title">Energy Map</h1>
        <p class="page-lead">
          日本の電力エリアを「市場 × 需給 × 天気」で眺めるためのミニマップ。いまは UI の骨組みだけ実装している状態。
        </p>
      </header>

      <section class="em-layout">
        <!-- 左：エリア地図 -->
        <section class="em-card em-area">
          <header class="em-card-header">
            <h2>Area</h2>
            <p class="em-meta">
              選択中：<span id="em-area-label">北陸 / Hokuriku</span>
            </p>
          </header>

          <div class="em-map-wrap">
            <!-- ★ JS で SVG ファイルを fetch してここにインライン挿入する -->
            <div id="em-map-inline" class="jp-energy-map" aria-label="Japan power grid areas"></div>
          </div>

          <p class="em-note">
            ※ いまはイラスト的な日本地図上でエリアを選択。後のフェーズで実データや指標と連携させていきます。
          </p>
        </section>

        <!-- 右：Snapshot -->
        <section class="em-card em-snapshot">
          <header class="em-card-header">
            <h2>Now Snapshot</h2>
            <p class="em-meta" id="em-snapshot-meta">
              北陸 / Hokuriku / 2025-11-16 00:00（ダミー値）
            </p>
          </header>
          <dl class="snapshot-grid">
            <div>
              <dt>予備率</dt>
              <dd id="em-snapshot-reserve">-- %</dd>
            </div>
            <div>
              <dt>需要</dt>
              <dd id="em-snapshot-demand">-- MW</dd>
            </div>
            <div>
              <dt>天気</dt>
              <dd id="em-snapshot-weather">--</dd>
            </div>
            <div>
              <dt>気温</dt>
              <dd id="em-snapshot-temp">-- ℃</dd>
            </div>
          </dl>
        </section>

        <!-- 下段フル幅：Market Panel -->
        <section class="em-card em-market">
          <header class="em-card-header">
            <h2>Market Panel</h2>
            <p class="em-meta" id="em-market-meta">
              北陸 / Hokuriku / 2025-11-16 00:00｜需給調整市場（EPRX） - 一次調整力
            </p>
          </header>

          <!-- ★ 日付・時間は Market 側に寄せる -->
          <div class="em-time-controls em-time-controls--market">
            <div class="field">
              <label for="em-date">日付</label>
              <input type="date" id="em-date">
            </div>
            <div class="field field-time">
              <label for="em-time-slider">時間スロット</label>
              <div class="time-row">
                <input type="range" id="em-time-slider" min="0" max="47" step="1">
                <span class="time-label" id="em-time-label">00:00</span>
                <button type="button" id="em-now-btn" class="btn btn-ghost">Now</button>
              </div>
            </div>
          </div>

          <div class="market-controls">
            <div class="field">
              <label for="em-market-select">市場</label>
              <select id="em-market-select">
                <option value="eprx">需給調整市場（EPRX）</option>
                <option value="jepx">卸電力市場（JEPX）</option>
              </select>
            </div>
            <div class="field">
              <label for="em-menu-select">メニュー</label>
              <select id="em-menu-select">
                <!-- JS で動的に差し替え -->
              </select>
            </div>
            <div class="field view-toggle">
              <span class="label">ビュー</span>
              <div class="segmented">
                <button type="button" class="seg-btn is-active" data-view="graph">Graph</button>
                <button type="button" class="seg-btn" data-view="table">Table</button>
              </div>
            </div>
          </div>

          <div class="market-view" id="em-market-view">
            <div class="market-placeholder">
              <h3 id="em-market-view-title">Frame only / EPRX - 一次調整力</h3>
              <p id="em-market-view-body">
                需給調整市場（EPRX）の一次調整力に関する指標を、時系列グラフで眺めるためのビュー。今はまだダミーの枠のみを実装し、データの差し込み方や指標セットを検討する段階。
              </p>
            </div>

            <!-- Graph ビュー用のダミー・フレーム -->
            <div class="market-graph-skeleton" id="em-market-graph">
              <div class="graph-grid">
                <div class="graph-y">
                  <span>High</span>
                  <span>Mid</span>
                  <span>Low</span>
                </div>
                <div class="graph-body">
                  <div class="graph-bar bar-1"></div>
                  <div class="graph-bar bar-2"></div>
                  <div class="graph-bar bar-3"></div>
                  <div class="graph-bar bar-4"></div>
                  <div class="graph-bar bar-5"></div>
                  <div class="graph-bar bar-6"></div>
                </div>
              </div>
              <p class="graph-caption">
                ※ 実データを接続する前のレイアウト確認用ダミー。将来的には 48 コマの価格・量などをここに重ねる想定。
              </p>
            </div>

            <!-- Table ビュー用のダミー・フレーム -->
            <div class="market-table-skeleton" id="em-market-table">
              <div class="table-head">
                <span>時刻</span>
                <span>指標A</span>
                <span>指標B</span>
                <span>指標C</span>
              </div>
              <div class="table-body">
                <div class="table-row">
                  <span>00:00</span><span>--</span><span>--</span><span>--</span>
                </div>
                <div class="table-row">
                  <span>03:00</span><span>--</span><span>--</span><span>--</span>
                </div>
                <div class="table-row">
                  <span>06:00</span><span>--</span><span>--</span><span>--</span>
                </div>
                <div class="table-row">
                  <span>09:00</span><span>--</span><span>--</span><span>--</span>
                </div>
                <div class="table-row">
                  <span>12:00</span><span>--</span><span>--</span><span>--</span>
                </div>
              </div>
              <p class="table-caption">
                ※ テーブルビューでは 30 分単位の行を並べ、後のフェーズで EPRX / JEPX の指標を埋め込むイメージ。
              </p>
            </div>
          </div>
        </section>
      </section>

      <!-- Data & License セクション（前回と同じ） -->
      <section class="em-card em-data-license">
        <header class="em-card-header">
          <h2>Data &amp; License</h2>
          <p class="em-meta">
            Energy Map で扱う予定のデータソースと、現時点での利用条件メモ。
          </p>
        </header>

        <div class="dl-note">
          <p>
            ※ 現段階ではどの外部データソースとも接続しておらず、このページでは UI の枠組みのみ提供しています。
            実データ接続の前に、各ソースの利用規約や二次利用条件を必ず確認します。
          </p>
        </div>

        <div class="dl-table-wrap">
          <table class="dl-table">
            <thead>
              <tr>
                <th>データ種別</th>
                <th>予定している取得元</th>
                <th>ライセンス / 利用条件メモ</th>
                <th>現状</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>電力需給（実績・予測）</td>
                <td>OCCTO / 電力広域運営推進機関</td>
                <td>一般向け利用不可。要契約・要審査。画面上の公開には別途合意が必要。</td>
                <td>まだ接続しない</td>
              </tr>
              <tr>
                <td>卸電力市場（JEPX）価格</td>
                <td>JEPX 公開情報</td>
                <td>二次利用・商用利用に制限あり。グラフ表示や履歴保存には転載条件を厳密に確認する。</td>
                <td>UI のみ用意</td>
              </tr>
              <tr>
                <td>需給調整市場（EPRX）</td>
                <td>経産省 EPRX 公開データ</td>
                <td>実データの扱いに注意。引用範囲や再配布に関する利用規定の確認が必須。</td>
                <td>UI のみ用意</td>
              </tr>
              <tr>
                <td>天気・気温</td>
                <td>Open-Meteo / 気象庁</td>
                <td>気象庁は出典明記が条件。Open-Meteo は商用利用可だが利用規約に従う。</td>
                <td>未接続</td>
              </tr>
              <tr>
                <td>アイコン / 図版</td>
                <td>Mochitecture 自作素材</td>
                <td>自作素材のため自由利用可能。</td>
                <td>OK</td>
              </tr>
              <tr>
                <td>日本地図ベース</td>
                <td>自作 SVG（Mochitecture）</td>
                <td>Mochitecture 著作の自作 SVG。Energy Map 内で自由に再利用可。</td>
                <td>完成済み</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </div>
  </main>

  <div data-include="/partials/footer.html"></div>
</body>
</html>
