/* ===== Energy Map 専用スタイル ===== */

.em-wrap{
  max-width:1200px;
  margin:0 auto;
  padding:32px 20px 48px;
}

.em-header{
  margin-bottom:20px;
}

.page-lead{
  margin:0 0 16px;
  font-size:14px;
  opacity:.9;
}

/* 日付・時間コントロール（Market 内で使用） */

.em-time-controls{
  display:flex;
  flex-wrap:wrap;
  gap:16px;
  padding:10px 12px;
  border-radius:12px;
  background:var(--card);
  border:1px solid #e5e7eb;
  margin-bottom:12px;
}

.em-time-controls--market{
  margin-top:4px;
}

.em-time-controls .field{
  display:flex;
  flex-direction:column;
  gap:4px;
  font-size:13px;
}

.em-time-controls label{
  opacity:.8;
}

.field-time{
  min-width:260px;
}

.time-row{
  display:flex;
  align-items:center;
  gap:12px;
}

#em-time-slider{
  flex:1;
}

.time-label{
  width:52px;
  font-variant-numeric:tabular-nums;
  text-align:right;
}

.btn-ghost{
  padding:.3rem .7rem;
  border-radius:.7rem;
  border:1px solid rgba(0,0,0,.08);
  background:transparent;
  font-size:13px;
  cursor:pointer;
}
.btn-ghost:hover{
  background:rgba(0,0,0,.04);
}

/* メインレイアウト：
   上段 Snapshot（2カラムぶち抜き）
   下段 左 Area / 右 Market
*/
.em-layout{
  display:grid;
  grid-template-columns:minmax(0,1.1fr) minmax(0,1.4fr);
  grid-template-rows:auto auto;
  gap:20px;
}

@media (max-width:960px){
  .em-layout{
    grid-template-columns:1fr;
    grid-template-rows:auto;
  }
}

.em-card{
  background:var(--card);
  border-radius:16px;
  box-shadow:var(--shadow);
  padding:18px 20px 16px;
}

/* 位置指定 */
.em-snapshot{
  grid-column:1 / span 2;
  grid-row:1;
}

.em-area{
  grid-column:1;
  grid-row:2;
  display:flex;
  flex-direction:column;
}

.em-market{
  grid-column:2;
  grid-row:2;
}

/* Snapshot：各項目を1行に収める */
.snapshot-grid{
  display:flex;
  flex-direction:column;
  gap:4px;
  margin:4px 0 0;
}

.snapshot-grid > div{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  padding:4px 0;
  border-bottom:1px solid #e5e7eb;
}

.snapshot-grid > div:last-child{
  border-bottom:none;
}

.snapshot-grid dt{
  font-size:.8rem;
  opacity:.7;
}

.snapshot-grid dd{
  margin:0;
  font-size:.95rem;
  font-variant-numeric:tabular-nums;
}

/* Card header */

.em-card-header{
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:8px;
  margin-bottom:10px;
}

.em-card-header h2{
  font-size:1.05rem;
  margin:0;
}

.em-meta{
  font-size:.8rem;
  opacity:.7;
}

/* ===== SVG 日本地図 ===== */

.em-map-wrap{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:8px 0 4px;
}

/* 外部 SVG を埋め込む <object> / inline SVG 両対応 */
.jp-energy-map{
  width:100%;
  max-width:360px; /* 380 → 360 など、少しだけ下げる */
  height:auto;
  display:block;
}

/* スマホ時は少し大きめにマップを見せる */
@media (max-width:600px){
  .jp-energy-map{
    max-width:420px;
  }
}

/* エリアカラー（参考画像に近いトーン） */
:root{
  --area-hokkaido:#2f86d9;
  --area-tohoku:#5675c7;
  --area-tokyo:#3fb3d4;
  --area-hokuriku:#a6c930;
  --area-chubu:#33a365;
  --area-kansai:#f3b222;
  --area-chugoku:#f28a22;
  --area-shikoku:#f25b3f;
  --area-kyushu:#e1354f;
}

/* インライン SVG で使う場合のスタイル */
.jp-area{
  stroke:rgba(0,0,0,.08);
  stroke-width:2;
  stroke-linejoin:round;
  stroke-linecap:round;
  fill:#e5e7eb;
  cursor:pointer;
  transition:transform .14s ease, filter .14s ease;
  transform-origin:center;
  touch-action:manipulation;
}

/* エリアごとの色 */
.jp-area[data-area="hokkaido"]{ fill:var(--area-hokkaido); }
.jp-area[data-area="tohoku"]{ fill:var(--area-tohoku); }
.jp-area[data-area="tokyo"]{ fill:var(--area-tokyo); }
.jp-area[data-area="hokuriku"]{ fill:var(--area-hokuriku); }
.jp-area[data-area="chubu"]{ fill:var(--area-chubu); }
.jp-area[data-area="kansai"]{ fill:var(--area-kansai); }
.jp-area[data-area="chugoku"]{ fill:var(--area-chugoku); }
.jp-area[data-area="shikoku"]{ fill:var(--area-shikoku); }
.jp-area[data-area="kyusyu"]{ fill:var(--area-kyushu); }

/* ★ ホバー時に「少し大きく」 */
.jp-area:hover{
  filter:brightness(1.05);
  transform:translateY(-1px) scale(1.04);
}

/* ★ クリック時の長方形枠を消しつつ、線だけ強調 */
.jp-area:focus-visible{
  outline:none;
  stroke:#111827;
  stroke-width:2.8;
}

.jp-area.is-active{
  stroke:#111827;
  stroke-width:2.8;
  filter:brightness(1.12);
}

.em-note{
  margin-top:6px;
  font-size:.75rem;
  opacity:.65;
}

/* Market */

.market-controls{
  display:flex;
  flex-wrap:wrap;
  gap:12px 16px;
  margin-bottom:10px;
}

.market-controls .field{
  display:flex;
  flex-direction:column;
  gap:4px;
  font-size:.8rem;
}

.market-controls label{
  opacity:.75;
}

.market-controls select{
  padding:6px 9px;
  border-radius:8px;
  border:1px solid #e5e7eb;
  background:var(--card);
  font-size:.86rem;
}

.view-toggle{
  margin-left:auto;
  min-width:160px;
}

.view-toggle .label{
  font-size:.8rem;
  opacity:.7;
  margin-bottom:4px;
}

.segmented{
  display:inline-flex;
  border-radius:999px;
  border:1px solid #e5e7eb;
  overflow:hidden;
}

.seg-btn{
  border:none;
  background:transparent;
  padding:5px 12px;
  font-size:.8rem;
  cursor:pointer;
}

.seg-btn.is-active{
  background:#111827;
  color:#fff;
}

.market-view{
  border-radius:12px;
  border:1px dashed #d1d5db;
  padding:12px 14px;
  background:rgba(249,250,251,.85);
  font-size:.85rem;
}

/* Graph / Table ビュー用フレーム */

.market-graph-skeleton,
.market-table-skeleton{
  margin-top:10px;
}

.graph-grid{
  display:grid;
  grid-template-columns:auto 1fr;
  gap:0 8px;
  align-items:stretch;
}

.graph-y{
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  font-size:.7rem;
  opacity:.7;
}

.graph-body{
  position:relative;
  min-height:160px;
  border-radius:10px;
  border:1px solid #e5e7eb;
  padding:6px 8px;
  overflow:hidden;
}

.graph-body::before{
  content:"";
  position:absolute;
  inset:0;
  background:repeating-linear-gradient(
    to right,
    rgba(156,163,175,.2),
    rgba(156,163,175,.2) 1px,
    transparent 1px,
    transparent 24px
  );
  opacity:.35;
  pointer-events:none;
}

/* バーを絶対配置して雰囲気だけ表現 */
.graph-bar{
  position:absolute;
  width:14px;
  border-radius:999px;
  background:rgba(31,41,55,.8);
}

.graph-bar.bar-1{ height:60%; bottom:0; left:6%; }
.graph-bar.bar-2{ height:40%; bottom:0; left:22%; }
.graph-bar.bar-3{ height:75%; bottom:0; left:38%; }
.graph-bar.bar-4{ height:50%; bottom:0; left:54%; }
.graph-bar.bar-5{ height:30%; bottom:0; left:70%; }
.graph-bar.bar-6{ height:65%; bottom:0; left:86%; }

.graph-caption,
.table-caption{
  margin-top:6px;
  font-size:.72rem;
  opacity:.7;
}

.table-head{
  display:grid;
  grid-template-columns:80px repeat(3, minmax(0,1fr));
  gap:4px;
  padding:6px 8px;
  border-radius:8px;
  background:rgba(243,244,246,.9);
  font-size:.75rem;
  font-weight:500;
}

.table-body{
  margin-top:4px;
  border-radius:8px;
  border:1px solid #e5e7eb;
  overflow:hidden;
}

.table-row{
  display:grid;
  grid-template-columns:80px repeat(3, minmax(0,1fr));
  gap:4px;
  padding:6px 8px;
  font-size:.75rem;
}

.table-row:nth-child(odd){
  background:rgba(249,250,251,.9);
}

.table-row:nth-child(even){
  background:#fff;
}

/* view クラスで Graph / Table を切り替え */

.market-view.is-graph #em-market-graph{
  display:block;
}
.market-view.is-graph #em-market-table{
  display:none;
}

.market-view.is-table #em-market-graph{
  display:none;
}
.market-view.is-table #em-market-table{
  display:block;
}

.market-placeholder h3{
  margin:0 0 4px;
  font-size:.9rem;
}

.market-placeholder p{
  margin:0;
  line-height:1.6;
}

/* Data & License セクション */

.em-data-license{
  margin-top:24px;
}

.dl-note{
  font-size:.78rem;
  opacity:.8;
}

.dl-note p{
  margin:0 0 8px;
}

.dl-table-wrap{
  margin-top:6px;
  overflow-x:auto;
}

.dl-table{
  width:100%;
  border-collapse:collapse;
  font-size:.78rem;
}

.dl-table th,
.dl-table td{
  padding:6px 8px;
  border-bottom:1px solid #e5e7eb;
  text-align:left;
  vertical-align:top;
}

.dl-table th{
  white-space:nowrap;
  font-weight:600;
  opacity:.8;
}

/* ダークモード微調整 */
@media (prefers-color-scheme: dark){
  .market-view{
    background:rgba(15,23,42,.6);
    border-color:#374151;
  }
  .market-placeholder p{
    color:#e5e7eb;
  }
  .graph-body{
    border-color:#4b5563;
  }
  .table-body{
    border-color:#4b5563;
  }
  .table-row:nth-child(odd){
    background:rgba(31,41,55,.6);
  }
  .table-row:nth-child(even){
    background:rgba(17,24,39,.9);
  }
  .dl-table th,
  .dl-table td{
    border-color:#374151;
  }
  .jp-area{
    stroke:rgba(15,23,42,.9);
  }
}
